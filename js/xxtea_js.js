const l={DELTA:2654435769,base64EncodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),base64DecodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],btoa(e){let r,n,o,t,c,F,i;for(n=o=0,t=e.length,c=t%3,t=t-c,F=t/3<<2,c>0&&(F+=4),r=new Array(F);n<t;)i=e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<8|e.charCodeAt(n++),r[o++]=l.base64EncodeChars[i>>18]+l.base64EncodeChars[i>>12&63]+l.base64EncodeChars[i>>6&63]+l.base64EncodeChars[i&63];return c===1?(i=e.charCodeAt(n++),r[o++]=`${l.base64EncodeChars[i>>2]+l.base64EncodeChars[(i&3)<<4]}==`):c===2&&(i=e.charCodeAt(n++)<<8|e.charCodeAt(n++),r[o++]=`${l.base64EncodeChars[i>>10]+l.base64EncodeChars[i>>4&63]+l.base64EncodeChars[(i&15)<<2]}=`),r.join("")},atob(e){let r,n,o,t,c,F,i,a,s,d;if(i=e.length,i%4!==0||/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(e))return"";for(e.charAt(i-2)==="="?a=1:e.charAt(i-1)==="="?a=2:a=0,s=i,a>0&&(s-=4),s=(s>>2)*3+a,d=new Array(s),c=F=0;c<i&&(r=l.base64DecodeChars[e.charCodeAt(c++)],!(r===-1||(n=l.base64DecodeChars[e.charCodeAt(c++)],n===-1)||(d[F++]=String.fromCharCode(r<<2|(n&48)>>4),o=l.base64DecodeChars[e.charCodeAt(c++)],o===-1)||(d[F++]=String.fromCharCode((n&15)<<4|(o&60)>>2),t=l.base64DecodeChars[e.charCodeAt(c++)],t===-1)));)d[F++]=String.fromCharCode((o&3)<<6|t);return d.join("")},toBinaryString(e,r){const n=e.length;let o=n<<2;if(r){const c=e[n-1];if(o-=4,c<o-3||c>o)return null;o=c}for(let c=0;c<n;c++)e[c]=String.fromCharCode(e[c]&255,e[c]>>>8&255,e[c]>>>16&255,e[c]>>>24&255);const t=e.join("");return r?t.substring(0,o):t},toUint32Array(e,r){const n=e.length;let o=n>>2;n&3&&++o;let t;r?(t=new Array(o+1),t[o]=n):t=new Array(o);for(let c=0;c<n;++c)t[c>>2]|=e.charCodeAt(c)<<((c&3)<<3);return t},int32(e){return e&4294967295},mx(e,r,n,o,t,c){return(n>>>5^r<<2)+(r>>>3^n<<4)^(e^r)+(c[o&3^t]^n)},fixk(e){return e.length<4&&(e.length=4),e},encryptUint32Array(e,r){const n=e.length,o=n-1;let t,c,F,i,a,s;for(c=e[o],F=0,s=Math.floor(6+52/n)|0;s>0;--s){for(F=l.int32(F+l.DELTA),i=F>>>2&3,a=0;a<o;++a)t=e[a+1],c=e[a]=l.int32(e[a]+l.mx(F,t,c,a,i,r));t=e[0],c=e[o]=l.int32(e[o]+l.mx(F,t,c,o,i,r))}return e},decryptUint32Array(e,r){const n=e.length,o=n-1;let t,c,F,i,a,s;for(t=e[0],s=Math.floor(6+52/n),F=l.int32(s*l.DELTA);F!==0;F=l.int32(F-l.DELTA)){for(i=F>>>2&3,a=o;a>0;--a)c=e[a-1],t=e[a]=l.int32(e[a]-l.mx(F,t,c,a,i,r));c=e[o],t=e[0]=l.int32(e[0]-l.mx(F,t,c,0,i,r))}return e},utf8Encode(e){if(/^[\x00-\x7F]*$/.test(e))return e;const r=[],n=e.length;for(let o=0,t=0;o<n;++o,++t){const c=e.charCodeAt(o);if(c<128)r[t]=e.charAt(o);else if(c<2048)r[t]=String.fromCharCode(192|c>>6,128|c&63);else if(c<55296||c>57343)r[t]=String.fromCharCode(224|c>>12,128|c>>6&63,128|c&63);else{if(o+1<n){const F=e.charCodeAt(o+1);if(c<56320&&F>=56320&&F<=57343){const i=((c&1023)<<10|F&1023)+65536;r[t]=String.fromCharCode(240|i>>18&63,128|i>>12&63,128|i>>6&63,128|i&63),++o;continue}}throw new Error("Malformed string")}}return r.join("")},utf8DecodeShortString(e,r){const n=new Array(r);let o=0,t=0;for(let c=e.length;o<r&&t<c;o++){const F=e.charCodeAt(t++);switch(F>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n[o]=F;break;case 12:case 13:if(t<c)n[o]=(F&31)<<6|e.charCodeAt(t++)&63;else throw new Error("Unfinished UTF-8 octet sequence");break;case 14:if(t+1<c)n[o]=(F&15)<<12|(e.charCodeAt(t++)&63)<<6|e.charCodeAt(t++)&63;else throw new Error("Unfinished UTF-8 octet sequence");break;case 15:if(t+2<c){const i=((F&7)<<18|(e.charCodeAt(t++)&63)<<12|(e.charCodeAt(t++)&63)<<6|e.charCodeAt(t++)&63)-65536;if(i>=0&&i<=1048575)n[o++]=i>>10&1023|55296,n[o]=i&1023|56320;else throw new Error(`Character outside valid Unicode range:0x${i.toString(16)}`)}else throw new Error("Unfinished UTF-8 octet sequence");break;default:throw new Error(`Bad UTF-8 encoding 0x${F.toString(16)}`)}}return o<r&&(n.length=o),String.fromCharCode.apply(String,n)},utf8DecodeLongString(e,r){const n=[],o=new Array(32768);let t=0,c=0;for(let F=e.length;t<r&&c<F;t++){const i=e.charCodeAt(c++);switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o[t]=i;break;case 12:case 13:if(c<F)o[t]=(i&31)<<6|e.charCodeAt(c++)&63;else throw new Error("Unfinished UTF-8 octet sequence");break;case 14:if(c+1<F)o[t]=(i&15)<<12|(e.charCodeAt(c++)&63)<<6|e.charCodeAt(c++)&63;else throw new Error("Unfinished UTF-8 octet sequence");break;case 15:if(c+2<F){const a=((i&7)<<18|(e.charCodeAt(c++)&63)<<12|(e.charCodeAt(c++)&63)<<6|e.charCodeAt(c++)&63)-65536;if(a>=0&&a<=1048575)o[t++]=a>>10&1023|55296,o[t]=a&1023|56320;else throw new Error(`Character outside valid Unicode range:0x${a.toString(16)}`)}else throw new Error("Unfinished UTF-8 octet sequence");break;default:throw new Error(`Bad UTF-8 encoding 0x${i.toString(16)}`)}if(t>=32767-1){const a=t+1;o.length=a,n[n.length]=String.fromCharCode.apply(String,o),r-=a,t=-1}}return t>0&&(o.length=t,n[n.length]=String.fromCharCode.apply(String,o)),n.join("")},utf8Decode(e,r){return(r==null||r<0)&&(r=e.length),r===0?"":/^[\x00-\x7F]*$/.test(e)||!/^[\x00-\xFF]*$/.test(e)?r===e.length?e:e.substr(0,r):r<32767?l.utf8DecodeShortString(e,r):l.utf8DecodeLongString(e,r)},encrypt(e,r){return e==null||e.length===0?e:(e=l.utf8Encode(e),r=l.utf8Encode(r),l.toBinaryString(l.encryptUint32Array(l.toUint32Array(e,!0),l.fixk(l.toUint32Array(r,!1))),!1))},decrypt(e,r){return e==null||e.length===0?e:(r=l.utf8Encode(r),l.utf8Decode(l.toBinaryString(l.decryptUint32Array(l.toUint32Array(e,!1),l.fixk(l.toUint32Array(r,!1))),!0)))}};

//xxtea 加密到base64
function xxtea_encrypt2base64(e, r) {
    return l.btoa(l.encrypt(e, r))
}

//xxtea 从base64解密
function xxtea_decryptFormBase64(e, r) {
    return e == null || e.length === 0 ? e : l.decrypt(l.atob(e), r)
}